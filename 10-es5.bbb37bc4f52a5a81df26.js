!function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var i,n=o(e);if(t){var r=o(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return s(this,i)}}function s(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{YtHQ:function(e,r,s){"use strict";s.r(r),s.d(r,"ExamModule",function(){return Z});var o,c=s("PCNd"),u=s("tyNb"),l=s("ofXK"),b=s("Q8ph"),m=s("xmsf"),h=s("fXoL"),g=s("e4Ts"),d=s("0/gI"),f=s("lJxs"),p=s("B0+h"),v=function(e){n(r,e);var t=a(r);function r(){return i(this,r),t.apply(this,arguments)}return r}(s("+Ag2").a),y=((o=function(e){n(s,e);var r=a(s);function s(){return i(this,s),r.apply(this,arguments)}return t(s,[{key:"getEntityPath",value:function(){return"exams"}},{key:"index",value:function(){return this.get(this.getUrl()).pipe(Object(f.a)(function(e){return e.data}),Object(f.a)(function(e){return e.map(function(e){return new p.a(e)})}))}},{key:"getById",value:function(e){var t=this.getUrl()+"/".concat(e);return this.get(t).pipe(Object(f.a)(function(e){return new p.a(e.data)}))}},{key:"getResult",value:function(e,t){var i=this.getUrl()+"/".concat(e,"/result/")+t;return this.get(i).pipe(Object(f.a)(function(e){return new v(e.data)}))}},{key:"submit",value:function(e,t){var i=this.getUrl()+"/".concat(e);return this.post(i,t).pipe(Object(f.a)(function(e){return e.data}))}}]),s}(d.a)).\u0275fac=function(e){return S(e||o)},o.\u0275prov=h.Kb({token:o,factory:o.\u0275fac,providedIn:"root"}),o),S=h.Wb(y),x=s("94Cn"),w=s("dc+m"),I=s("IfeN"),O=s("YK+t"),T=s("Wp6s");function k(e,t){if(1&e){var i=h.Vb();h.Ub(0,"div",3),h.Ub(1,"div",4),h.Ub(2,"h4",5),h.Gc(3),h.Tb(),h.Tb(),h.Ub(4,"div",6),h.Ub(5,"mat-card-content"),h.Ub(6,"div",0),h.Ub(7,"div",7),h.Ub(8,"b"),h.Gc(9,"T\u1ed5ng s\u1ed1 c\xe2u"),h.Tb(),h.Gc(10),h.Pb(11,"br"),h.Ub(12,"b"),h.Gc(13,"Th\u1eddi gian l\xe0m"),h.Tb(),h.Gc(14),h.Pb(15,"br"),h.Gc(16),h.Tb(),h.Ub(17,"div",8),h.Ub(18,"button",9),h.bc("click",function(){h.xc(i);var e=t.$implicit;return h.fc().goToExam(e)}),h.Gc(19," B\u1eaft \u0111\u1ea7u l\xe0m b\xe0i "),h.Tb(),h.Tb(),h.Tb(),h.Tb(),h.Tb(),h.Tb()}if(2&e){var n=t.$implicit;h.Db(3),h.Hc(n.title),h.Db(7),h.Ic(": ",n.number_question," "),h.Db(4),h.Ic(": ",n.time," (ph\xfat) "),h.Db(2),h.Ic(" ",n.description," ")}}var P,q,D=((P=function(){function e(t,n,r,a,s,o,c){i(this,e),this.route=t,this.sessionStorageService=n,this.router=r,this.examService=a,this.subjectService=s,this.breadcrumbService=o,this.notificationService=c}return t(e,[{key:"ngOnInit",value:function(){var e=this;this.subjectId=b.a.getId(this.route.snapshot.paramMap.get("mon-thi")),this.contestId=b.a.getId(this.route.snapshot.paramMap.get("ky-thi")),this.subjectService.getExams(this.subjectId).subscribe(function(t){e.exams=t}),this.subjectService.getById(this.subjectId).subscribe(function(t){e.breadcrumbService.setItem(b.a.parentUrl(e.router.url),t.title)})}},{key:"ngOnDestroy",value:function(){}},{key:"goToExam",value:function(e){b.a.isActiveOrder(this.sessionStorageService.retrieve(m.a.Order),this.contestId)?(this.router.navigate([this.router.url,b.a.convertToUrl(e.title,e.id)],{queryParams:{reset:"reset"}}),this.sessionStorageService.store("exam_"+e.id,{start_time:Object(l.u)(new Date,"yyyy/MM/dd HH:mm","en"),end_time:Object(l.u)((new Date).setMinutes((new Date).getMinutes()+e.time),"yyyy/MM/dd HH:mm","en")})):this.notificationService.warning("Vui l\xf2ng mua kh\xf3a h\u1ecdc \u0111\u1ec3 s\u1eed d\u1ee5ng t\xednh n\u0103ng n\xe0y!")}}]),e}()).\u0275fac=function(e){return new(e||P)(h.Ob(u.a),h.Ob(g.b),h.Ob(u.d),h.Ob(y),h.Ob(x.a),h.Ob(w.a),h.Ob(I.a))},P.\u0275cmp=h.Ib({type:P,selectors:[["ng-component"]],decls:4,vars:1,consts:[[1,"row"],[1,"col-lg-12"],["class","card cursor-pointer hover-shadow-wrapper",4,"ngFor","ngForOf"],[1,"card","cursor-pointer","hover-shadow-wrapper"],[1,"card-header","card-header-info"],[1,"card-title"],[1,"card-body"],[1,"col-md-8"],[1,"col-md-4"],[1,"btn","btn-sm","pull-right","btn-primary",3,"click"]],template:function(e,t){1&e&&(h.Pb(0,"app-order-contest"),h.Ub(1,"div",0),h.Ub(2,"div",1),h.Ec(3,k,20,4,"div",2),h.Tb(),h.Tb()),2&e&&(h.Db(3),h.mc("ngForOf",t.exams))},directives:[O.a,l.j,T.b],encapsulation:2}),P),U=s("0IaG"),z=s("bTqV"),M=((q=function(){function e(t){i(this,e),this.data=t}return t(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||q)(h.Ob(U.a))},q.\u0275cmp=h.Ib({type:q,selectors:[["app-dialog"]],decls:9,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[3,"innerHTML"],["align","end"],["mat-button","","mat-dialog-close","",3,"mat-dialog-close"],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,t){1&e&&(h.Ub(0,"h2",0),h.Gc(1),h.Tb(),h.Ub(2,"mat-dialog-content",1),h.Pb(3,"h3",2),h.Tb(),h.Ub(4,"mat-dialog-actions",3),h.Ub(5,"button",4),h.Gc(6,"Cancel"),h.Tb(),h.Ub(7,"button",5),h.Gc(8,"Submit"),h.Tb(),h.Tb()),2&e&&(h.Db(1),h.Hc(t.data.title),h.Db(2),h.mc("innerHTML",t.data.message,h.yc),h.Db(2),h.mc("mat-dialog-close",!1),h.Db(2),h.mc("mat-dialog-close",!0))},directives:[U.g,U.e,U.c,z.a,U.d],encapsulation:2}),q),j=s("M9IT"),_=s("hp31"),E=s("Cc/g");function A(e,t){if(1&e&&h.Pb(0,"app-question-item",9),2&e){var i=h.fc(),n=i.$implicit,r=i.index,a=h.fc();h.mc("question",n)("questionNumber",a.currentPage*a.pageSize+r+1)("examId",a.examId)}}function N(e,t){if(1&e&&h.Pb(0,"app-question-group",9),2&e){var i=h.fc(),n=i.$implicit,r=i.index,a=h.fc();h.mc("question",n)("questionNumber",a.currentPage*a.pageSize+r+1)("examId",a.examId)}}function H(e,t){if(1&e&&(h.Ub(0,"div"),h.Ec(1,A,1,3,"app-question-item",8),h.Ec(2,N,1,3,"app-question-group",8),h.Tb()),2&e){var i=t.$implicit;h.Db(1),h.mc("ngIf",i.isSingle),h.Db(1),h.mc("ngIf",i.isParent)}}var B,F=((B=function(){function e(t,n,r,a,s,o,c){i(this,e),this.router=t,this.route=n,this.sessionStorageService=r,this.examService=a,this.notificationService=s,this.dialog=o,this.breadcrumbService=c,this.isSticky=!1,this.isSubmitting=!1,this.pageSize=10,this.currentPage=0,this.totalSize=0}return t(e,[{key:"ngOnInit",value:function(){var e=this;this.examId=b.a.getId(this.route.snapshot.paramMap.get("de-thi")),this.route.queryParams.subscribe(function(t){e.shouldResetQueryParams=t.reset}),this.examService.getById(this.examId).subscribe(function(t){e.exam=t,e.questions=e.paginate(t.questions,e.pageSize,1),e.totalSize=t.questions.length,e.lastPage=Math.ceil(e.totalSize/e.pageSize)-1,e.resetStorage(),e.getCountdown()}),this.breadcrumbService.setItem(b.a.parentUrl(this.router.url),"Danh s\xe1ch \u0111\u1ec1 thi")}},{key:"ngOnDestroy",value:function(){clearInterval(this.timeInterval)}},{key:"handlePage",value:function(e){b.a.scrollTop(),this.questions=this.paginate(this.exam.questions,e.pageSize,e.pageIndex+1),this.currentPage=e.pageIndex}},{key:"submit",value:function(){var e=this;this.dialog.open(M,{data:{title:"B\u1ea1n \u0111\xe3 ch\u1eafc ch\u1eafn mu\u1ed1n n\u1ed9p b\xe0i?",message:"<b>B\u1ea1n \u0111\xe3 tr\u1ea3 l\u1eddi: </b>"+this.getNumberAnswered()+"/"+this.getTotalNumberQuestions()}}).afterClosed().subscribe(function(t){t&&e.submitExam()})}},{key:"submitExam",value:function(){var e=this;if(!this.isSubmitting){this.isSubmitting=!0;var t={answer:this.getAnsweredQuestions(),start_time:this.getExamInfo().start_time,end_time:Object(l.u)(new Date,"yyyy/MM/dd HH:mm:ss","en")};this.examService.submit(this.examId,t).subscribe(function(t){e.notificationService.success("B\u1ea1n \u0111\xe3 n\u1ed9p b\xe0i th\xe0nh c\xf4ng!"),e.sessionStorageService.clear("exam_"+e.examId),e.sessionStorageService.clear("exam_"+e.examId+"_answers"),e.router.navigate([e.router.url,"result",t.id])})}}},{key:"isLastPage",value:function(){return this.currentPage===this.lastPage}},{key:"checkScroll",value:function(){this.isSticky=window.pageYOffset>=250}},{key:"getNumberAnswered",value:function(){return this.getAnsweredQuestions()?Object.keys(this.getAnsweredQuestions()).length:0}},{key:"getAnsweredQuestions",value:function(){return this.sessionStorageService.retrieve("exam_"+this.examId+"_answers")}},{key:"getExamInfo",value:function(){return this.sessionStorageService.retrieve("exam_"+this.examId)}},{key:"getTotalNumberQuestions",value:function(){var e=0;return this.exam&&this.exam.questions?(this.exam.questions.forEach(function(t){e+=t.isParent?t.children.length:1}),e):0}},{key:"getCountdown",value:function(){var e=this;this.timeInterval=setInterval(function(){var t=(new Date).getTime(),i=e.getExamInfo(),n=new Date(i.end_time).getTime()-t;e.timeHour=Math.floor(n%864e5/36e5),e.timeMinute=Math.floor(n%36e5/6e4),e.timeSecond=Math.floor(n%6e4/1e3),n<0&&(clearInterval(e.timeInterval),e.submitExam()),e.timeHour<1&&e.timeMinute<5&&(e.shouldWarningTime=!0)},1e3)}},{key:"paginate",value:function(e,t,i){return e.slice((i-1)*t,i*t)}},{key:"resetStorage",value:function(){var e=this.getExamInfo();(this.shouldResetQueryParams||!e||e&&Date.parse(e.end_time)<Date.now())&&(this.sessionStorageService.clear("exam_"+this.examId+"_answers"),this.sessionStorageService.clear("exam_"+this.examId),this.sessionStorageService.store("exam_"+this.examId,{start_time:Object(l.u)(new Date,"yyyy/MM/dd HH:mm:ss","en"),end_time:Object(l.u)((new Date).setMinutes((new Date).getMinutes()+this.exam.time),"yyyy/MM/dd HH:mm:ss","en")})),this.router.navigate([],{queryParams:{}})}}]),e}()).\u0275fac=function(e){return new(e||B)(h.Ob(u.d),h.Ob(u.a),h.Ob(g.b),h.Ob(y),h.Ob(I.a),h.Ob(U.b),h.Ob(w.a))},B.\u0275cmp=h.Ib({type:B,selectors:[["app-exam-item"]],hostBindings:function(e,t){1&e&&h.bc("mousewheel",function(e){return t.checkScroll(e)})("touchmove",function(e){return t.checkScroll(e)})("scroll",function(e){return t.checkScroll(e)},!1,h.wc)},decls:10,vars:14,consts:[["id","countdown-time",1,"text-center",2,"z-index","999999",3,"ngClass"],["mat-raised-button","",2,"font-size","20px",3,"color"],[1,"grid","grid-cols-1","gap-1",2,"margin","auto","padding-bottom","10px"],[4,"ngFor","ngForOf"],[3,"pageSize","showFirstLastButtons","length","pageIndex","hidePageSize","page"],["paginator",""],[1,"text-center",2,"padding","15px 0"],["mat-raised-button","","color","primary",1,"text-center",2,"font-size","24px",3,"disabled","click"],[3,"question","questionNumber","examId",4,"ngIf"],[3,"question","questionNumber","examId"]],template:function(e,t){1&e&&(h.Ub(0,"div",0),h.Ub(1,"button",1),h.Gc(2),h.Tb(),h.Tb(),h.Ub(3,"div",2),h.Ec(4,H,3,2,"div",3),h.Tb(),h.Ub(5,"mat-paginator",4,5),h.bc("page",function(e){return t.handlePage(e)}),h.Tb(),h.Ub(7,"div",6),h.Ub(8,"button",7),h.bc("click",function(){return t.submit()}),h.Gc(9,"N\u1ed9p b\xe0i"),h.Tb(),h.Tb()),2&e&&(h.mc("ngClass",t.isSticky?"sticky":""),h.Db(1),h.nc("color",t.shouldWarningTime?"warn":"primary"),h.Db(1),h.Lc(" Time: ",t.timeHour?t.timeHour+":":"","",t.timeMinute,":",t.timeSecond," | B\u1ea1n \u0111\xe3 tr\u1ea3 l\u1eddi: ",t.getNumberAnswered(),"/",t.getTotalNumberQuestions()," "),h.Db(2),h.mc("ngForOf",t.questions),h.Db(1),h.mc("pageSize",t.pageSize)("showFirstLastButtons",!0)("length",t.totalSize)("pageIndex",t.currentPage)("hidePageSize",!0),h.Db(3),h.mc("disabled",!t.getNumberAnswered()))},directives:[l.i,z.a,l.j,j.a,l.k,_.a,E.a],encapsulation:2}),B),G=s("eIep");function L(e,t){if(1&e&&(h.Ub(0,"div",6),h.Ub(1,"button",7),h.Gc(2),h.Tb(),h.Tb()),2&e){var i=h.fc();h.Db(2),h.Jc(" S\u1ed1 c\xe2u tr\u1ea3 l\u1eddi \u0111\xfang: ",i.getAnalyticsNumber()[1]," / ",i.getAnalyticsNumber()[0]," ")}}function C(e,t){if(1&e&&h.Pb(0,"app-question-item",10),2&e){var i=h.fc(),n=i.$implicit,r=i.index,a=h.fc();h.mc("question",n)("questionNumber",a.currentPage*a.pageSize+r+1)("canShowAnswer",!0)("result",a.result)("forceShowAnswer",!0)}}function Q(e,t){if(1&e&&h.Pb(0,"app-question-group",11),2&e){var i=h.fc(),n=i.$implicit,r=i.index,a=h.fc();h.mc("question",n)("questionNumber",a.currentPage*a.pageSize+r+1)("showAnswer",!0)("result",a.result)("forceShowAnswer",!0)}}function R(e,t){if(1&e&&(h.Ub(0,"div"),h.Ec(1,C,1,5,"app-question-item",8),h.Ec(2,Q,1,5,"app-question-group",9),h.Tb()),2&e){var i=t.$implicit;h.Db(1),h.mc("ngIf",i.isSingle),h.Db(1),h.mc("ngIf",i.isParent)}}var $,J,W,K=[{path:"",component:D},{path:":de-thi",component:F},{path:":de-thi/result/:result-id",component:($=function(){function e(t,n,r,a,s){i(this,e),this.router=t,this.route=n,this.sessionStorageService=r,this.examService=a,this.breadcrumbService=s,this.pageSize=10,this.currentPage=0,this.totalSize=0}return t(e,[{key:"ngOnInit",value:function(){var e=this;this.examId=b.a.getId(this.route.snapshot.paramMap.get("de-thi")),this.resultId=b.a.getId(this.route.snapshot.paramMap.get("result-id")),this.examService.getResult(this.examId,this.resultId).pipe(Object(G.a)(function(t){return e.result=JSON.parse(t.answer),e.examService.getById(e.examId)})).subscribe(function(t){e.exam=t,e.questions=e.paginate(t.questions,e.pageSize,1),e.totalSize=t.questions.length,e.lastPage=Math.ceil(e.totalSize/e.pageSize)-1}),this.breadcrumbService.setItem(b.a.parentUrl(this.router.url,3),"Danh s\xe1ch \u0111\u1ec1 thi")}},{key:"ngOnDestroy",value:function(){}},{key:"handlePage",value:function(e){b.a.scrollTop(),this.questions=this.paginate(this.exam.questions,e.pageSize,e.pageIndex+1),this.currentPage=e.pageIndex}},{key:"isLastPage",value:function(){return this.currentPage===this.lastPage}},{key:"getAnalyticsNumber",value:function(){var e=this;if(this.analytics)return this.analytics;var t=0,i=0;return this.exam.questions.forEach(function(n){n.isParent?(t+=n.children.length,n.children.forEach(function(t){e.result&&t.id in e.result&&t.correct_answer===e.result[t.id]&&i++})):(t+=1,e.result&&n.id in e.result&&n.correct_answer===e.result[n.id]&&i++)}),this.analytics=[t,i]}},{key:"paginate",value:function(e,t,i){return e.slice((i-1)*t,i*t)}}]),e}(),$.\u0275fac=function(e){return new(e||$)(h.Ob(u.d),h.Ob(u.a),h.Ob(g.b),h.Ob(y),h.Ob(w.a))},$.\u0275cmp=h.Ib({type:$,selectors:[["app-exam-item-result"]],decls:6,vars:7,consts:[[2,"pointer-events","none"],["style","text-align: center; padding: 5px 0",4,"ngIf"],[1,"grid","grid-cols-1","gap-1",2,"margin","auto","padding-bottom","10px"],[4,"ngFor","ngForOf"],[3,"pageSize","showFirstLastButtons","length","pageIndex","hidePageSize","page"],["paginator",""],[2,"text-align","center","padding","5px 0"],["mat-raised-button","","color","primary",2,"font-size","24px"],[3,"question","questionNumber","canShowAnswer","result","forceShowAnswer",4,"ngIf"],[3,"question","questionNumber","showAnswer","result","forceShowAnswer",4,"ngIf"],[3,"question","questionNumber","canShowAnswer","result","forceShowAnswer"],[3,"question","questionNumber","showAnswer","result","forceShowAnswer"]],template:function(e,t){1&e&&(h.Ub(0,"div",0),h.Ec(1,L,3,2,"div",1),h.Ub(2,"div",2),h.Ec(3,R,3,2,"div",3),h.Tb(),h.Tb(),h.Ub(4,"mat-paginator",4,5),h.bc("page",function(e){return t.handlePage(e)}),h.Tb()),2&e&&(h.Db(1),h.mc("ngIf",t.exam),h.Db(2),h.mc("ngForOf",t.questions),h.Db(1),h.mc("pageSize",t.pageSize)("showFirstLastButtons",!0)("length",t.totalSize)("pageIndex",t.currentPage)("hidePageSize",!0))},directives:[l.k,l.j,j.a,z.a,_.a,E.a],encapsulation:2}),$)}],V=((J=function e(){i(this,e)}).\u0275fac=function(e){return new(e||J)},J.\u0275mod=h.Mb({type:J}),J.\u0275inj=h.Lb({imports:[[u.g.forChild(K)],u.g]}),J),Y=s("9DjR"),X=s("sHgf"),Z=((W=function e(){i(this,e)}).\u0275fac=function(e){return new(e||W)},W.\u0275mod=h.Mb({type:W}),W.\u0275inj=h.Lb({imports:[[c.a,V,Y.SectionModule,X.a]]}),W)}}])}();