(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{YtHQ:function(e,t,i){"use strict";i.r(t),i.d(t,"ExamModule",function(){return Q});var s=i("PCNd"),n=i("tyNb"),r=i("ofXK"),a=i("Q8ph"),o=i("xmsf"),c=i("fXoL"),u=i("e4Ts"),h=i("0/gI"),b=i("lJxs"),m=i("B0+h"),g=i("+Ag2");class d extends g.a{}let l=(()=>{class e extends h.a{getEntityPath(){return"exams"}index(){return this.get(this.getUrl()).pipe(Object(b.a)(e=>e.data),Object(b.a)(e=>e.map(e=>new m.a(e))))}getById(e){const t=this.getUrl()+`/${e}`;return this.get(t).pipe(Object(b.a)(e=>new m.a(e.data)))}getResult(e,t){const i=this.getUrl()+`/${e}/result/`+t;return this.get(i).pipe(Object(b.a)(e=>new d(e.data)))}submit(e,t){const i=this.getUrl()+`/${e}`;return this.post(i,t).pipe(Object(b.a)(e=>e.data))}}return e.\u0275fac=function(t){return p(t||e)},e.\u0275prov=c.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const p=c.Wb(l);var f=i("94Cn"),S=i("dc+m"),x=i("IfeN"),v=i("YK+t"),I=i("Wp6s");function w(e,t){if(1&e){const e=c.Vb();c.Ub(0,"div",3),c.Ub(1,"div",4),c.Ub(2,"h4",5),c.Gc(3),c.Tb(),c.Tb(),c.Ub(4,"div",6),c.Ub(5,"mat-card-content"),c.Ub(6,"div",0),c.Ub(7,"div",7),c.Ub(8,"b"),c.Gc(9,"T\u1ed5ng s\u1ed1 c\xe2u"),c.Tb(),c.Gc(10),c.Pb(11,"br"),c.Ub(12,"b"),c.Gc(13,"Th\u1eddi gian l\xe0m"),c.Tb(),c.Gc(14),c.Pb(15,"br"),c.Gc(16),c.Tb(),c.Ub(17,"div",8),c.Ub(18,"button",9),c.bc("click",function(){c.xc(e);const i=t.$implicit;return c.fc().goToExam(i)}),c.Gc(19," B\u1eaft \u0111\u1ea7u l\xe0m b\xe0i "),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&e){const e=t.$implicit;c.Db(3),c.Hc(e.title),c.Db(7),c.Ic(": ",e.number_question," "),c.Db(4),c.Ic(": ",e.time," (ph\xfat) "),c.Db(2),c.Ic(" ",e.description," ")}}let y=(()=>{class e{constructor(e,t,i,s,n,r,a){this.route=e,this.sessionStorageService=t,this.router=i,this.examService=s,this.subjectService=n,this.breadcrumbService=r,this.notificationService=a}ngOnInit(){this.subjectId=a.a.getId(this.route.snapshot.paramMap.get("mon-thi")),this.contestId=a.a.getId(this.route.snapshot.paramMap.get("ky-thi")),this.subjectService.getExams(this.subjectId).subscribe(e=>{this.exams=e}),this.subjectService.getById(this.subjectId).subscribe(e=>{this.breadcrumbService.setItem(a.a.parentUrl(this.router.url),e.title)})}ngOnDestroy(){}goToExam(e){a.a.isActiveOrder(this.sessionStorageService.retrieve(o.a.Order),this.contestId)?(this.router.navigate([this.router.url,a.a.convertToUrl(e.title,e.id)],{queryParams:{reset:"reset"}}),this.sessionStorageService.store("exam_"+e.id,{start_time:Object(r.u)(new Date,"yyyy/MM/dd HH:mm","en"),end_time:Object(r.u)((new Date).setMinutes((new Date).getMinutes()+e.time),"yyyy/MM/dd HH:mm","en")})):this.notificationService.warning("Vui l\xf2ng mua kh\xf3a h\u1ecdc \u0111\u1ec3 s\u1eed d\u1ee5ng t\xednh n\u0103ng n\xe0y!")}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(n.a),c.Ob(u.b),c.Ob(n.d),c.Ob(l),c.Ob(f.a),c.Ob(S.a),c.Ob(x.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["ng-component"]],decls:4,vars:1,consts:[[1,"row"],[1,"col-lg-12"],["class","card cursor-pointer hover-shadow-wrapper",4,"ngFor","ngForOf"],[1,"card","cursor-pointer","hover-shadow-wrapper"],[1,"card-header","card-header-info"],[1,"card-title"],[1,"card-body"],[1,"col-md-8"],[1,"col-md-4"],[1,"btn","btn-sm","pull-right","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.Pb(0,"app-order-contest"),c.Ub(1,"div",0),c.Ub(2,"div",1),c.Ec(3,w,20,4,"div",2),c.Tb(),c.Tb()),2&e&&(c.Db(3),c.mc("ngForOf",t.exams))},directives:[v.a,r.j,I.b],encapsulation:2}),e})();var T=i("0IaG"),O=i("bTqV");let q=(()=>{class e{constructor(e){this.data=e}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(T.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-dialog"]],decls:9,vars:4,consts:[["mat-dialog-title",""],[1,"mat-typography"],[3,"innerHTML"],["align","end"],["mat-button","","mat-dialog-close","",3,"mat-dialog-close"],["mat-raised-button","","color","primary","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,t){1&e&&(c.Ub(0,"h2",0),c.Gc(1),c.Tb(),c.Ub(2,"mat-dialog-content",1),c.Pb(3,"h3",2),c.Tb(),c.Ub(4,"mat-dialog-actions",3),c.Ub(5,"button",4),c.Gc(6,"Cancel"),c.Tb(),c.Ub(7,"button",5),c.Gc(8,"Submit"),c.Tb(),c.Tb()),2&e&&(c.Db(1),c.Hc(t.data.title),c.Db(2),c.mc("innerHTML",t.data.message,c.yc),c.Db(2),c.mc("mat-dialog-close",!1),c.Db(2),c.mc("mat-dialog-close",!0))},directives:[T.g,T.e,T.c,O.a,T.d],encapsulation:2}),e})();var P=i("M9IT"),D=i("hp31"),U=i("Cc/g");function z(e,t){if(1&e&&c.Pb(0,"app-question-item",9),2&e){const e=c.fc(),t=e.$implicit,i=e.index,s=c.fc();c.mc("question",t)("questionNumber",s.currentPage*s.pageSize+i+1)("examId",s.examId)}}function M(e,t){if(1&e&&c.Pb(0,"app-question-group",9),2&e){const e=c.fc(),t=e.$implicit,i=e.index,s=c.fc();c.mc("question",t)("questionNumber",s.currentPage*s.pageSize+i+1)("examId",s.examId)}}function A(e,t){if(1&e&&(c.Ub(0,"div"),c.Ec(1,z,1,3,"app-question-item",8),c.Ec(2,M,1,3,"app-question-group",8),c.Tb()),2&e){const e=t.$implicit;c.Db(1),c.mc("ngIf",e.isSingle),c.Db(1),c.mc("ngIf",e.isParent)}}let N=(()=>{class e{constructor(e,t,i,s,n,r,a){this.router=e,this.route=t,this.sessionStorageService=i,this.examService=s,this.notificationService=n,this.dialog=r,this.breadcrumbService=a,this.isSticky=!1,this.isSubmitting=!1,this.pageSize=10,this.currentPage=0,this.totalSize=0}ngOnInit(){this.examId=a.a.getId(this.route.snapshot.paramMap.get("de-thi")),this.route.queryParams.subscribe(e=>{this.shouldResetQueryParams=e.reset}),this.examService.getById(this.examId).subscribe(e=>{this.exam=e,this.questions=this.paginate(e.questions,this.pageSize,1),this.totalSize=e.questions.length,this.lastPage=Math.ceil(this.totalSize/this.pageSize)-1,this.resetStorage(),this.getCountdown()}),this.breadcrumbService.setItem(a.a.parentUrl(this.router.url),"Danh s\xe1ch \u0111\u1ec1 thi")}ngOnDestroy(){clearInterval(this.timeInterval)}handlePage(e){a.a.scrollTop(),this.questions=this.paginate(this.exam.questions,e.pageSize,e.pageIndex+1),this.currentPage=e.pageIndex}submit(){this.dialog.open(q,{data:{title:"B\u1ea1n \u0111\xe3 ch\u1eafc ch\u1eafn mu\u1ed1n n\u1ed9p b\xe0i?",message:"<b>B\u1ea1n \u0111\xe3 tr\u1ea3 l\u1eddi: </b>"+this.getNumberAnswered()+"/"+this.getTotalNumberQuestions()}}).afterClosed().subscribe(e=>{e&&this.submitExam()})}submitExam(){if(this.isSubmitting)return;this.isSubmitting=!0;const e={answer:this.getAnsweredQuestions(),start_time:this.getExamInfo().start_time,end_time:Object(r.u)(new Date,"yyyy/MM/dd HH:mm:ss","en")};this.examService.submit(this.examId,e).subscribe(e=>{this.notificationService.success("B\u1ea1n \u0111\xe3 n\u1ed9p b\xe0i th\xe0nh c\xf4ng!"),this.sessionStorageService.clear("exam_"+this.examId),this.sessionStorageService.clear("exam_"+this.examId+"_answers"),this.router.navigate([this.router.url,"result",e.id])})}isLastPage(){return this.currentPage===this.lastPage}checkScroll(){this.isSticky=window.pageYOffset>=250}getNumberAnswered(){return this.getAnsweredQuestions()?Object.keys(this.getAnsweredQuestions()).length:0}getAnsweredQuestions(){return this.sessionStorageService.retrieve("exam_"+this.examId+"_answers")}getExamInfo(){return this.sessionStorageService.retrieve("exam_"+this.examId)}getTotalNumberQuestions(){let e=0;return this.exam&&this.exam.questions?(this.exam.questions.forEach(t=>{e+=t.isParent?t.children.length:1}),e):0}getCountdown(){this.timeInterval=setInterval(()=>{const e=(new Date).getTime(),t=this.getExamInfo(),i=new Date(t.end_time).getTime()-e;this.timeHour=Math.floor(i%864e5/36e5),this.timeMinute=Math.floor(i%36e5/6e4),this.timeSecond=Math.floor(i%6e4/1e3),i<0&&(clearInterval(this.timeInterval),this.submitExam()),this.timeHour<1&&this.timeMinute<5&&(this.shouldWarningTime=!0)},1e3)}paginate(e,t,i){return e.slice((i-1)*t,i*t)}resetStorage(){const e=this.getExamInfo();(this.shouldResetQueryParams||!e||e&&Date.parse(e.end_time)<Date.now())&&(this.sessionStorageService.clear("exam_"+this.examId+"_answers"),this.sessionStorageService.clear("exam_"+this.examId),this.sessionStorageService.store("exam_"+this.examId,{start_time:Object(r.u)(new Date,"yyyy/MM/dd HH:mm:ss","en"),end_time:Object(r.u)((new Date).setMinutes((new Date).getMinutes()+this.exam.time),"yyyy/MM/dd HH:mm:ss","en")})),this.router.navigate([],{queryParams:{}})}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(n.d),c.Ob(n.a),c.Ob(u.b),c.Ob(l),c.Ob(x.a),c.Ob(T.b),c.Ob(S.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-exam-item"]],hostBindings:function(e,t){1&e&&c.bc("mousewheel",function(e){return t.checkScroll(e)})("touchmove",function(e){return t.checkScroll(e)})("scroll",function(e){return t.checkScroll(e)},!1,c.wc)},decls:10,vars:14,consts:[["id","countdown-time",1,"text-center",2,"z-index","999999",3,"ngClass"],["mat-raised-button","",2,"font-size","20px",3,"color"],[1,"grid","grid-cols-1","gap-1",2,"margin","auto","padding-bottom","10px"],[4,"ngFor","ngForOf"],[3,"pageSize","showFirstLastButtons","length","pageIndex","hidePageSize","page"],["paginator",""],[1,"text-center",2,"padding","15px 0"],["mat-raised-button","","color","primary",1,"text-center",2,"font-size","24px",3,"disabled","click"],[3,"question","questionNumber","examId",4,"ngIf"],[3,"question","questionNumber","examId"]],template:function(e,t){1&e&&(c.Ub(0,"div",0),c.Ub(1,"button",1),c.Gc(2),c.Tb(),c.Tb(),c.Ub(3,"div",2),c.Ec(4,A,3,2,"div",3),c.Tb(),c.Ub(5,"mat-paginator",4,5),c.bc("page",function(e){return t.handlePage(e)}),c.Tb(),c.Ub(7,"div",6),c.Ub(8,"button",7),c.bc("click",function(){return t.submit()}),c.Gc(9,"N\u1ed9p b\xe0i"),c.Tb(),c.Tb()),2&e&&(c.mc("ngClass",t.isSticky?"sticky":""),c.Db(1),c.nc("color",t.shouldWarningTime?"warn":"primary"),c.Db(1),c.Lc(" Time: ",t.timeHour?t.timeHour+":":"","",t.timeMinute,":",t.timeSecond," | B\u1ea1n \u0111\xe3 tr\u1ea3 l\u1eddi: ",t.getNumberAnswered(),"/",t.getTotalNumberQuestions()," "),c.Db(2),c.mc("ngForOf",t.questions),c.Db(1),c.mc("pageSize",t.pageSize)("showFirstLastButtons",!0)("length",t.totalSize)("pageIndex",t.currentPage)("hidePageSize",!0),c.Db(3),c.mc("disabled",!t.getNumberAnswered()))},directives:[r.i,O.a,r.j,P.a,r.k,D.a,U.a],encapsulation:2}),e})();var j=i("eIep");function E(e,t){if(1&e&&(c.Ub(0,"div",6),c.Ub(1,"button",7),c.Gc(2),c.Tb(),c.Tb()),2&e){const e=c.fc();c.Db(2),c.Jc(" S\u1ed1 c\xe2u tr\u1ea3 l\u1eddi \u0111\xfang: ",e.getAnalyticsNumber()[1]," / ",e.getAnalyticsNumber()[0]," ")}}function _(e,t){if(1&e&&c.Pb(0,"app-question-item",10),2&e){const e=c.fc(),t=e.$implicit,i=e.index,s=c.fc();c.mc("question",t)("questionNumber",s.currentPage*s.pageSize+i+1)("canShowAnswer",!0)("result",s.result)("forceShowAnswer",!0)}}function k(e,t){if(1&e&&c.Pb(0,"app-question-group",11),2&e){const e=c.fc(),t=e.$implicit,i=e.index,s=c.fc();c.mc("question",t)("questionNumber",s.currentPage*s.pageSize+i+1)("showAnswer",!0)("result",s.result)("forceShowAnswer",!0)}}function H(e,t){if(1&e&&(c.Ub(0,"div"),c.Ec(1,_,1,5,"app-question-item",8),c.Ec(2,k,1,5,"app-question-group",9),c.Tb()),2&e){const e=t.$implicit;c.Db(1),c.mc("ngIf",e.isSingle),c.Db(1),c.mc("ngIf",e.isParent)}}const B=[{path:"",component:y},{path:":de-thi",component:N},{path:":de-thi/result/:result-id",component:(()=>{class e{constructor(e,t,i,s,n){this.router=e,this.route=t,this.sessionStorageService=i,this.examService=s,this.breadcrumbService=n,this.pageSize=10,this.currentPage=0,this.totalSize=0}ngOnInit(){this.examId=a.a.getId(this.route.snapshot.paramMap.get("de-thi")),this.resultId=a.a.getId(this.route.snapshot.paramMap.get("result-id")),this.examService.getResult(this.examId,this.resultId).pipe(Object(j.a)(e=>(this.result=JSON.parse(e.answer),this.examService.getById(this.examId)))).subscribe(e=>{this.exam=e,this.questions=this.paginate(e.questions,this.pageSize,1),this.totalSize=e.questions.length,this.lastPage=Math.ceil(this.totalSize/this.pageSize)-1}),this.breadcrumbService.setItem(a.a.parentUrl(this.router.url,3),"Danh s\xe1ch \u0111\u1ec1 thi")}ngOnDestroy(){}handlePage(e){a.a.scrollTop(),this.questions=this.paginate(this.exam.questions,e.pageSize,e.pageIndex+1),this.currentPage=e.pageIndex}isLastPage(){return this.currentPage===this.lastPage}getAnalyticsNumber(){if(this.analytics)return this.analytics;let e=0,t=0;return this.exam.questions.forEach(i=>{i.isParent?(e+=i.children.length,i.children.forEach(e=>{this.result&&e.id in this.result&&e.correct_answer===this.result[e.id]&&t++})):(e+=1,this.result&&i.id in this.result&&i.correct_answer===this.result[i.id]&&t++)}),this.analytics=[e,t]}paginate(e,t,i){return e.slice((i-1)*t,i*t)}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(n.d),c.Ob(n.a),c.Ob(u.b),c.Ob(l),c.Ob(S.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-exam-item-result"]],decls:6,vars:7,consts:[[2,"pointer-events","none"],["style","text-align: center; padding: 5px 0",4,"ngIf"],[1,"grid","grid-cols-1","gap-1",2,"margin","auto","padding-bottom","10px"],[4,"ngFor","ngForOf"],[3,"pageSize","showFirstLastButtons","length","pageIndex","hidePageSize","page"],["paginator",""],[2,"text-align","center","padding","5px 0"],["mat-raised-button","","color","primary",2,"font-size","24px"],[3,"question","questionNumber","canShowAnswer","result","forceShowAnswer",4,"ngIf"],[3,"question","questionNumber","showAnswer","result","forceShowAnswer",4,"ngIf"],[3,"question","questionNumber","canShowAnswer","result","forceShowAnswer"],[3,"question","questionNumber","showAnswer","result","forceShowAnswer"]],template:function(e,t){1&e&&(c.Ub(0,"div",0),c.Ec(1,E,3,2,"div",1),c.Ub(2,"div",2),c.Ec(3,H,3,2,"div",3),c.Tb(),c.Tb(),c.Ub(4,"mat-paginator",4,5),c.bc("page",function(e){return t.handlePage(e)}),c.Tb()),2&e&&(c.Db(1),c.mc("ngIf",t.exam),c.Db(2),c.mc("ngForOf",t.questions),c.Db(1),c.mc("pageSize",t.pageSize)("showFirstLastButtons",!0)("length",t.totalSize)("pageIndex",t.currentPage)("hidePageSize",!0))},directives:[r.k,r.j,P.a,O.a,D.a,U.a],encapsulation:2}),e})()}];let F=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({imports:[[n.g.forChild(B)],n.g]}),e})();var G=i("9DjR"),L=i("sHgf");let Q=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({imports:[[s.a,F,G.SectionModule,L.a]]}),e})()}}]);